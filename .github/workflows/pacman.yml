name: Generate Pacman GIF

on:
  schedule:
    - cron: "0 12 * * *"
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Create custom Pacman SVG
        run: |
          mkdir -p dist
          cat > dist/github-contribution-grid-snake.svg << 'EOF'
          <svg width="100%" height="120" xmlns="http://www.w3.org/2000/svg">
            <style>
              @keyframes move-dots {
                0% { transform: translateX(500px); }
                100% { transform: translateX(-500px); }
              }
              
              @keyframes eat-mouth {
                0%, 100% { 
                  clip-path: polygon(50% 50%, 100% 20%, 100% 80%);
                }
                50% { 
                  clip-path: polygon(50% 50%, 100% 0%, 100% 100%);
                }
              }
              
              @keyframes dot-disappear {
                0%, 90% { opacity: 1; transform: scale(1); }
                95%, 100% { opacity: 0; transform: scale(0); }
              }
              
              .pacman-body {
                fill: #FFD700;
              }
              
              .pacman-mouth {
                fill: #0d0000;
                animation: eat-mouth 0.4s infinite;
              }
              
              .dots-container {
                animation: move-dots 5s infinite linear;
              }
              
              .dot {
                fill: #FFD700;
              }
              
              /* –¢–æ—á–∫–∏ –∏—Å—á–µ–∑–∞—é—Ç —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 0.2s */
              .dot:nth-child(1) { animation: dot-disappear 3s infinite 0.2s; }
              .dot:nth-child(2) { animation: dot-disappear 3s infinite 0.4s; }
              .dot:nth-child(3) { animation: dot-disappear 3s infinite 0.6s; }
              .dot:nth-child(4) { animation: dot-disappear 3s infinite 0.8s; }
              .dot:nth-child(5) { animation: dot-disappear 3s infinite 0.0s; }
              .dot:nth-child(6) { animation: dot-disappear 3s infinite 1.2s; }
            </style>
            
            <!-- –§–æ–Ω -->
            <rect width="100%" height="100%" fill="#0d0000"/>
            
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <text x="50%" y="25" text-anchor="middle" fill="#FFD700" font-family="Times New Roman" font-size="16" font-weight="bold">
              üéÆ Pacman Eating Dots
            </text>
            
            <!-- –ü–∞–∫–º–µ–Ω —Å–ª–µ–≤–∞ -->
            <g transform="translate(100, 65)">
              <!-- –ñ–µ–ª—Ç–æ–µ —Ç–µ–ª–æ -->
              <circle cx="0" cy="0" r="20" class="pacman-body"/>
              <!-- –ß–µ—Ä–Ω—ã–π —Ä–æ—Ç -->
              <circle cx="0" cy="0" r="20" class="pacman-mouth"/>
              <!-- –ì–ª–∞–∑ -->
              <circle cx="-8" cy="-10" r="3" fill="#000"/>
            </g>
            
            <!-- –¢–æ—á–∫–∏ —Å –∞–±—Å–æ–ª—é—Ç–Ω—ã–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ -->
            <g class="dots-container">
              <circle cx="150" cy="65" r="5" class="dot"/>
              <circle cx="200" cy="65" r="5" class="dot"/>
              <circle cx="250" cy="65" r="5" class="dot"/>
              <circle cx="300" cy="65" r="5" class="dot"/>
              <circle cx="350" cy="65" r="5" class="dot"/>
              <circle cx="400" cy="65" r="5" class="dot"/>
            </g>
            
          </svg>
          EOF
          
      - name: Deploy to output branch
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./dist
          publish_branch: output
          force_orphan: true
          commit_message: "Update Pacman animation"
