name: Generate Pacman

on:
  schedule:
    - cron: "0 12 * * *"
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Create Pacman SVG
        run: |
          mkdir -p dist
          cat > dist/pacman.svg << 'EOF'
          <svg width="100%" height="120" xmlns="http://www.w3.org/2000/svg">
            <style>
              @keyframes move-dots {
                0% { transform: translateX(800px); }
                100% { transform: translateX(-100px); }
              }
              
              @keyframes eat-mouth {
                0%, 100% { 
                  clip-path: polygon(50% 50%, 100% 0%, 100% 100%);
                }
                50% { 
                  clip-path: polygon(50% 50%, 100% 25%, 100% 75%);
                }
              }
              
              @keyframes dot-disappear {
                0%, 90% { opacity: 1; r: 4; }
                95%, 100% { opacity: 0; r: 0; }
              }
              
              .pacman-body {
                fill: #FFD700; /* –í—Å–µ —Ç–µ–ª–æ –∂–µ–ª—Ç–æ–µ */
              }
              
              .pacman-mouth {
                fill: #0d1117; /* –†–æ—Ç —á–µ—Ä–Ω—ã–π */
                animation: eat-mouth 0.3s infinite;
              }
              
              .dots-container {
                animation: move-dots 3s infinite linear;
              }
              
              .dot {
                fill: #FFD700;
              }
              
              /* –ö–∞–∂–¥–∞—è —Ç–æ—á–∫–∞ –∏—Å—á–µ–∑–∞–µ—Ç –∫–æ–≥–¥–∞ –¥–æ—Ö–æ–¥–∏—Ç –¥–æ –ü–∞–∫–º–µ–Ω–∞ */
              .dot:nth-child(1) { animation: dot-disappear 3s infinite 0.3s; }
              .dot:nth-child(2) { animation: dot-disappear 3s infinite 0.6s; }
              .dot:nth-child(3) { animation: dot-disappear 3s infinite 0.9s; }
              .dot:nth-child(4) { animation: dot-disappear 3s infinite 1.2s; }
              .dot:nth-child(5) { animation: dot-disappear 3s infinite 1.5s; }
              .dot:nth-child(6) { animation: dot-disappear 3s infinite 1.8s; }
              .dot:nth-child(7) { animation: dot-disappear 3s infinite 2.1s; }
              .dot:nth-child(8) { animation: dot-disappear 3s infinite 2.4s; }
              .dot:nth-child(9) { animation: dot-disappear 3s infinite 2.7s; }
            </style>
            
            <!-- –§–æ–Ω -->
            <rect width="100%" height="100%" fill="#0d1117"/>
            
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <text x="50%" y="25" text-anchor="middle" fill="#FFD700" font-family="Arial" font-size="16" font-weight="bold">
              üéÆ Pacman Eating Dots
            </text>
            
            <!-- –î–æ—Ä–æ–∂–∫–∞ -->
            <line x1="50" y1="80" x2="750" y2="80" stroke="#333" stroke-width="2"/>
            
            <!-- –ü–∞–∫–º–µ–Ω (—Å—Ç–æ–∏—Ç –Ω–∞ –º–µ—Å—Ç–µ) -->
            <g transform="translate(100, 80)">
              <!-- –ñ–µ–ª—Ç–æ–µ —Ç–µ–ª–æ -->
              <circle cx="0" cy="0" r="20" class="pacman-body"/>
              <!-- –ß–µ—Ä–Ω—ã–π —Ä–æ—Ç (–¥–≤–∏–≥–∞–µ—Ç—Å—è) -->
              <circle cx="0" cy="0" r="20" class="pacman-mouth"/>
              <!-- –ì–ª–∞–∑ -->
              <circle cx="-8" cy="-10" r="3" fill="#000"/>
            </g>
            
            <!-- –¢–æ—á–∫–∏ (–¥–≤–∏–≥–∞—é—Ç—Å—è –∫ –ü–∞–∫–º–µ–Ω—É) -->
            <g class="dots-container" transform="translate(0, 80)">
              <circle cx="200" cy="0" r="4" class="dot"/>
              <circle cx="250" cy="0" r="4" class="dot"/>
              <circle cx="300" cy="0" r="4" class="dot"/>
              <circle cx="350" cy="0" r="4" class="dot"/>
              <circle cx="400" cy="0" r="4" class="dot"/>
              <circle cx="450" cy="0" r="4" class="dot"/>
              <circle cx="500" cy="0" r="4" class="dot"/>
              <circle cx="550" cy="0" r="4" class="dot"/>
              <circle cx="600" cy="0" r="4" class="dot"/>
            </g>
            
          </svg>
          EOF
          
      - name: Deploy to output branch
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./dist
          publish_branch: output
          force_orphan: true
          commit_message: "Update Pacman animation"
